class Button{constructor(t){if(!(t&&t instanceof HTMLElement))return this;this.$root=t,this.debounceFormSubmitTimer=null,this.$root.addEventListener("keydown",this.handleKeyDown.bind(this)),this.$root.addEventListener("click",this.debounce.bind(this))}handleKeyDown(t){const{target:e}=t;"button"===e.getAttribute("role")&&32===t.keyCode&&(t.preventDefault(),e.click())}debounce(t){const{target:e}=t;if("true"===e.getAttribute("data-prevent-double-click"))return this.debounceFormSubmitTimer?(t.preventDefault(),!1):void(this.debounceFormSubmitTimer=setTimeout((()=>{this.debounceFormSubmitTimer=null}),1e3))}}function initButton(t={}){(t.scope||document).querySelectorAll('[data-module="nhsuk-button"]').forEach((t=>{new Button(t)}))}class CharacterCount{constructor(t){if(!(t&&t instanceof HTMLElement))return this;const e=t.querySelector(".nhsuk-js-character-count");if(!e||!(e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement))return this;this.$root=t,this.$textarea=e,this.$visibleCountMessage=null,this.$screenReaderCountMessage=null,this.lastInputTimestamp=null;const s=document.getElementById(`${this.$textarea.id}-info`);this.$textarea.insertAdjacentElement("afterend",s);const i=document.createElement("div");i.className="nhsuk-character-count__sr-status nhsuk-u-visually-hidden",i.setAttribute("aria-live","polite"),this.$screenReaderCountMessage=i,s.insertAdjacentElement("afterend",i);const n=document.createElement("div");n.className=s.className,n.classList.add("nhsuk-character-count__status"),n.setAttribute("aria-hidden","true"),this.$visibleCountMessage=n,s.insertAdjacentElement("afterend",n),s.classList.add("nhsuk-u-visually-hidden"),this.options=CharacterCount.getDataset(this.$root);let a=this.defaults.characterCountAttribute;if(this.options.maxwords&&(a=this.defaults.wordCountAttribute),this.maxLength=this.$root.getAttribute(a),!this.maxLength)return this;this.$textarea.removeAttribute("maxlength"),this.bindChangeEvents(),"onpageshow"in window?window.addEventListener("pageshow",this.updateCountMessage.bind(this)):window.addEventListener("DOMContentLoaded",this.updateCountMessage.bind(this)),this.updateCountMessage()}static getDataset(t){const e={},{attributes:s}=t;if(s)for(let i=0;i<s.length;i++){const t=s[i],n=t.name.match(/^data-(.+)/);n&&(e[n[1]]=t.value)}return e}count(t){let e;if(this.options.maxwords){e=(t.match(/\S+/g)||[]).length}else e=t.length;return e}bindChangeEvents(){const{$textarea:t}=this;t.addEventListener("keyup",this.handleKeyUp.bind(this)),t.addEventListener("focus",this.handleFocus.bind(this)),t.addEventListener("blur",this.handleBlur.bind(this))}checkIfValueChanged(){this.$textarea.oldValue||(this.$textarea.oldValue=""),this.$textarea.value!==this.$textarea.oldValue&&(this.$textarea.oldValue=this.$textarea.value,this.updateCountMessage())}updateCountMessage(){this.updateVisibleCountMessage(),this.updateScreenReaderCountMessage()}updateVisibleCountMessage(){const{$textarea:t}=this,{$visibleCountMessage:e}=this,s=this.maxLength-this.count(t.value);this.isOverThreshold()?e.classList.remove("nhsuk-character-count__message--disabled"):e.classList.add("nhsuk-character-count__message--disabled"),s<0?(t.classList.add("nhsuk-textarea--error"),e.classList.remove("nhsuk-hint"),e.classList.add("nhsuk-error-message")):(t.classList.remove("nhsuk-textarea--error"),e.classList.remove("nhsuk-error-message"),e.classList.add("nhsuk-hint")),e.innerHTML=this.formattedUpdateMessage()}updateScreenReaderCountMessage(){const{$screenReaderCountMessage:t}=this;this.isOverThreshold()?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",!0),t.innerHTML=this.formattedUpdateMessage()}formattedUpdateMessage(){const{$textarea:t}=this,{options:e}=this,s=this.maxLength-this.count(t.value);let i="remaining",n="character",a=s;return e.maxwords&&(n="word"),n+=-1===s||1===s?"":"s",i=s<0?"too many":"remaining",a=Math.abs(s),`You have ${a} ${n} ${i}`}isOverThreshold(){const{$textarea:t}=this,{options:e}=this,s=this.count(t.value),{maxLength:i}=this;return i*(e.threshold?e.threshold:0)/100<=s}handleKeyUp(){this.updateVisibleCountMessage(),this.lastInputTimestamp=Date.now()}handleFocus(){this.valueChecker=setInterval((()=>{(!this.lastInputTimestamp||Date.now()-500>=this.lastInputTimestamp)&&this.checkIfValueChanged()}),1e3)}handleBlur(){clearInterval(this.valueChecker)}}function initCharacterCount(t={}){(t.scope||document).querySelectorAll('[data-module="nhsuk-character-count"]').forEach((t=>{new CharacterCount(t)}))}function toggleAttribute(t,e){if(!t||!e)return;const s="true"===t.getAttribute(e)?"false":"true";t.setAttribute(e,s)}function toggleConditionalInput(t,e){if(!t||!e)return;const s=t.getAttribute("aria-controls");if(s){const i=document.getElementById(s);i&&(t.checked?(i.classList.remove(e),t.setAttribute("aria-expanded","true")):(i.classList.add(e),t.setAttribute("aria-expanded","false")))}}CharacterCount.prototype.defaults={characterCountAttribute:"data-maxlength",wordCountAttribute:"data-maxwords"};class Checkboxes{constructor(t){if(!(t&&t instanceof HTMLElement))return this;this.$root=t;const e=this.$root.querySelectorAll(".nhsuk-checkboxes__input");if(!e.length)return this;this.$inputs=e,"onpageshow"in window?window.addEventListener("pageshow",(()=>this.syncAllConditionalReveals())):window.addEventListener("DOMContentLoaded",(()=>this.syncAllConditionalReveals())),this.syncAllConditionalReveals(),this.$inputs.forEach((t=>{t.addEventListener("change",this.handleClick.bind(this))}))}syncAllConditionalReveals(){this.$inputs.forEach((t=>toggleConditionalInput(t,"nhsuk-checkboxes__conditional--hidden")))}unCheckAllInputsExcept(t){t.form.querySelectorAll(`input[type="checkbox"][data-checkbox-exclusive-group="${t.getAttribute("data-checkbox-exclusive-group")}"]`).forEach((e=>{t.form===e.form&&e!==t&&(e.checked=!1)})),this.syncAllConditionalReveals()}unCheckExclusiveInputs(t){t.form.querySelectorAll(`input[type="checkbox"][data-checkbox-exclusive][data-checkbox-exclusive-group="${t.getAttribute("data-checkbox-exclusive-group")}"]`).forEach((e=>{t.form===e.form&&(e.checked=!1)})),this.syncAllConditionalReveals()}handleClick(t){toggleConditionalInput(t.target,"nhsuk-checkboxes__conditional--hidden"),t.target.checked&&(t.target.hasAttribute("data-checkbox-exclusive")?this.unCheckAllInputsExcept(t.target):this.unCheckExclusiveInputs(t.target))}}function initCheckboxes(t={}){(t.scope||document).querySelectorAll(".nhsuk-checkboxes").forEach((t=>{new Checkboxes(t)}))}class Details{constructor(t){if(!(t&&t instanceof HTMLElement))return this;this.$root=t;"HTMLDetailsElement"in window&&this.$root instanceof HTMLDetailsElement||this.polyfillDetails()}polyfillDetails(){const t=this.$root.querySelector(".nhsuk-details__text");t.id||t.setAttribute("id",`details-content-${function(){let t=(new Date).getTime();return void 0!==window.performance&&"function"==typeof window.performance.now&&(t+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const s=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?s:3&s|8).toString(16)}))}()}`);const e=this.$root.querySelector(".nhsuk-details__summary");e.setAttribute("role","button"),e.setAttribute("aria-controls",t.id),e.setAttribute("tabIndex","0");!0===(null!==this.$root.getAttribute("open"))?(e.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false")):(e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"),t.style.display="none");e.addEventListener("click",(()=>{toggleAttribute(e,"aria-expanded"),toggleAttribute(t,"aria-hidden"),t.style.display="true"===t.getAttribute("aria-hidden")?"none":"",this.$root.hasAttribute("open")?this.$root.removeAttribute("open"):this.$root.setAttribute("open","open")})),e.addEventListener("keydown",(t=>{13!==t.keyCode&&32!==t.keyCode||(t.preventDefault(),e.click())}))}}function initDetails(t={}){(t.scope||document).querySelectorAll(".nhsuk-details").forEach((t=>{new Details(t)}))}class ErrorSummary{constructor(t,e={}){if(!(t&&t instanceof HTMLElement))return this;this.$root=t,this.$root.addEventListener("click",this.handleClick.bind(this)),e.disableAutoFocus||this.$root.focus()}getAssociatedLegendOrLabel(t){const e=t.closest("fieldset");if(e){const s=e.getElementsByTagName("legend");if(s.length){const e=s[0];if("checkbox"===t.type||"radio"===t.type)return e;const i=e.getBoundingClientRect().top,n=t.getBoundingClientRect();if(n.height&&window.innerHeight){if(n.top+n.height-i<window.innerHeight/2)return e}}}return document.querySelector(`label[for='${t.getAttribute("id")}']`)||t.closest("label")}focusTarget(t){if("A"!==t.tagName||!1===t.href)return!1;const e=document.querySelector(t.hash);if(!e)return!1;const s=this.getAssociatedLegendOrLabel(e);return!!s&&(s.scrollIntoView(),e.focus({preventScroll:!0}),!0)}handleClick(t){this.focusTarget(t.target)&&t.preventDefault()}}function initErrorSummary(t={}){const e=(t.scope||document).querySelector(".nhsuk-error-summary");new ErrorSummary(e,{disableAutoFocus:!1===t.focusOnPageLoad})}class Header{constructor(t){return t&&t instanceof HTMLElement?(this.$root=t,this.navigation=this.$root.querySelector(".nhsuk-header__navigation"),this.navigationList=this.$root.querySelector(".nhsuk-header__navigation-list"),this.navigationItems=this.$root.querySelectorAll(".nhsuk-header__navigation-item"),this.menu=this.$root.querySelector(".nhsuk-header__menu"),this.menuToggle=this.$root.querySelector(".nhsuk-header__menu-toggle"),this.navigation&&this.navigationList&&this.navigationItems&&this.navigationItems.length&&this.menu&&this.menuToggle?(this.menuList=document.createElement("ul"),this.menuIsEnabled=!1,this.menuIsOpen=!1,this.handleEscapeKey=this.onEscapeKey.bind(this),this.handleUpdateNavigation=this.debounce(this.updateNavigation),this.handleToggleMenu=this.toggleMenu.bind(this),this.setupNavigation(),void this.updateNavigation()):this):this}debounce(t,e=100){let s;return(...i)=>{clearTimeout(s),s=setTimeout((()=>{t.apply(this,i)}),e)}}resetNavigation(){let t=0;this.breakpoints.forEach((e=>{this.navigationList.insertBefore(e.element,this.menu),t+=e.element.offsetWidth,e.right=t})),this.width=this.navigationList.offsetWidth}setupNavigation(){this.breakpoints=[],this.navigationItems.forEach((t=>{this.breakpoints.push({element:t,right:0})})),window.addEventListener("resize",this.handleUpdateNavigation)}setupMenu(){this.menuList.parentElement||(this.menuList.classList.add("nhsuk-header__menu-list"),this.menuList.setAttribute("hidden",""),this.menu.appendChild(this.menuList))}enableMenu(){this.menuIsEnabled||(this.menuIsEnabled=!0,this.menu.removeAttribute("hidden"),this.menuToggle.addEventListener("click",this.handleToggleMenu))}disableMenu(){this.menuIsEnabled&&(this.closeMenu(),this.menuIsEnabled=!1,this.menu.setAttribute("hidden",""),this.menuToggle.removeEventListener("click",this.handleToggleMenu))}closeMenu(){this.menuIsEnabled&&this.menuIsOpen&&(this.menuIsOpen=!1,this.menuList.setAttribute("hidden",""),this.menuToggle.setAttribute("aria-expanded","false"),this.navigation.style.removeProperty("border-bottom-width"),document.removeEventListener("keydown",this.handleEscapeKey))}onEscapeKey(t){"Escape"===t.key&&this.closeMenu()}openMenu(){this.menuIsEnabled&&!this.menuIsOpen&&(this.menuIsOpen=!0,this.menuList.removeAttribute("hidden"),this.menuToggle.setAttribute("aria-expanded","true"),this.navigation.style.setProperty("border-bottom-width",`${this.menuList.offsetHeight}px`),document.addEventListener("keydown",this.handleEscapeKey))}toggleMenu(){this.menuIsEnabled&&(this.menuIsOpen?this.closeMenu():this.openMenu())}updateNavigation(){this.resetNavigation(),this.breakpoints.filter((t=>t.right>this.width)).length?(this.setupMenu(),this.enableMenu(),this.width-=this.menu.offsetWidth,this.breakpoints.forEach((t=>{t.right>this.width&&this.menuList.insertAdjacentElement("beforeend",t.element)})),this.menuIsOpen&&this.navigation.style.setProperty("border-bottom-width",`${this.menuList.offsetHeight}px`)):this.disableMenu()}}function initHeader(t={}){const e=(t.scope||document).querySelector(".nhsuk-header");new Header(e)}class Radios{constructor(t){if(!(t&&t instanceof HTMLElement))return this;this.$root=t;const e=this.$root.querySelectorAll(".nhsuk-radios__input");if(!e.length)return this;this.$inputs=e,"onpageshow"in window?window.addEventListener("pageshow",(()=>this.syncAllConditionalReveals())):window.addEventListener("DOMContentLoaded",(()=>this.syncAllConditionalReveals())),this.$inputs.forEach((t=>{t.addEventListener("change",(()=>this.syncAllConditionalReveals()))}))}syncAllConditionalReveals(){this.$inputs.forEach((t=>toggleConditionalInput(t,"nhsuk-radios__conditional--hidden")))}}function initRadios(t={}){(t.scope||document).querySelectorAll(".nhsuk-radios--conditional").forEach((t=>{new Radios(t)}))}class SkipLink{constructor(t){if(!(t&&t instanceof HTMLAnchorElement))return this;this.$root=t;const e=this.$root.hash.split("#").pop(),s=e?document.getElementById(e):null;if(!s)return this;this.$root.addEventListener("click",(()=>function(t,e={}){const s=t.getAttribute("tabindex");function onBlur(){t.removeEventListener("blur",onBlur),e.onBlur&&e.onBlur.call(t),s||t.removeAttribute("tabindex")}s||t.setAttribute("tabindex","-1"),t.addEventListener("focus",(function onFocus(){t.removeEventListener("focus",onFocus),t.addEventListener("blur",onBlur)})),e.onBeforeFocus&&e.onBeforeFocus.call(t),t.focus()}(s,{onBeforeFocus(){s.classList.add("nhsuk-skip-link-focused-element")},onBlur(){s.classList.remove("nhsuk-skip-link-focused-element")}})))}}function initSkipLink(t={}){const e=(t.scope||document).querySelector(".nhsuk-skip-link");new SkipLink(e)}class Tabs{constructor(t){if(!(t&&t instanceof HTMLElement))return this;this.$root=t;const e=this.$root.querySelectorAll(".nhsuk-tabs__tab"),s=this.$root.querySelector(".nhsuk-tabs__list"),i=this.$root.querySelectorAll(".nhsuk-tabs__list-item");if(!e.length||!s||!i.length)return this;this.$tabs=e,this.$tabList=s,this.$tabListItems=i,this.boundTabClick=this.onTabClick.bind(this),this.boundTabKeydown=this.onTabKeydown.bind(this),this.boundOnHashChange=this.onHashChange.bind(this),this.keys={down:40,left:37,right:39,up:38},this.jsHiddenClass="nhsuk-tabs__panel--hidden",this.showEvent=new CustomEvent("tab.show"),this.hideEvent=new CustomEvent("tab.hide"),"function"==typeof window.matchMedia?this.setupResponsiveChecks():this.setup()}setupResponsiveChecks(){this.mql=window.matchMedia("(min-width: 641px)"),"addEventListener"in this.mql?this.mql.addEventListener("change",this.checkMode.bind(this)):this.mql.addListener(this.checkMode.bind(this)),this.checkMode()}checkMode(){this.mql.matches?this.setup():this.teardown()}setup(){this.$tabList.setAttribute("role","tablist"),this.$tabListItems.forEach((t=>{t.setAttribute("role","presentation")})),this.$tabs.forEach((t=>{this.setAttributes(t),t.addEventListener("click",this.boundTabClick,!0),t.addEventListener("keydown",this.boundTabKeydown,!0),this.hideTab(t)}));const t=this.getTab(window.location.hash)||this.$tabs[0];this.showTab(t),window.addEventListener("hashchange",this.boundOnHashChange,!0)}teardown(){this.$tabList.removeAttribute("role"),this.$tabListItems.forEach((t=>{t.removeAttribute("role","presentation")})),this.$tabs.forEach((t=>{t.removeEventListener("click",this.boundTabClick,!0),t.removeEventListener("keydown",this.boundTabKeydown,!0),this.unsetAttributes(t)})),window.removeEventListener("hashchange",this.boundOnHashChange,!0)}onHashChange(){const{hash:t}=window.location,e=this.getTab(t);if(!e)return;if(this.changingHash)return void(this.changingHash=!1);const s=this.getCurrentTab();this.hideTab(s),this.showTab(e),e.focus()}hideTab(t){this.unhighlightTab(t),this.hidePanel(t)}showTab(t){this.highlightTab(t),this.showPanel(t)}getTab(t){return this.$root.querySelector(`.nhsuk-tabs__tab[href="${t}"]`)}setAttributes(t){const e=Tabs.getHref(t).slice(1);t.setAttribute("id",`tab_${e}`),t.setAttribute("role","tab"),t.setAttribute("aria-controls",e),t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1");const s=this.getPanel(t);s.setAttribute("role","tabpanel"),s.setAttribute("aria-labelledby",t.id),s.classList.add(this.jsHiddenClass)}unsetAttributes(t){t.removeAttribute("id"),t.removeAttribute("role"),t.removeAttribute("aria-controls"),t.removeAttribute("aria-selected"),t.removeAttribute("tabindex");const e=this.getPanel(t);e.removeAttribute("role"),e.removeAttribute("aria-labelledby"),e.removeAttribute("tabindex"),e.classList.remove(this.jsHiddenClass)}onTabClick(t){const e=this.getCurrentTab(),s=t.currentTarget;e&&s instanceof HTMLAnchorElement&&(t.preventDefault(),this.hideTab(e),this.showTab(s),this.createHistoryEntry(s))}createHistoryEntry(t){const e=this.getPanel(t),{id:s}=e;e.id="",this.changingHash=!0,window.location.hash=Tabs.getHref(t).slice(1),e.id=s}onTabKeydown(t){switch(t.keyCode){case this.keys.left:case this.keys.up:this.activatePreviousTab(),t.preventDefault();break;case this.keys.right:case this.keys.down:this.activateNextTab(),t.preventDefault()}}activateNextTab(){const t=this.getCurrentTab(),e=t.parentNode.nextElementSibling;let s;e&&(s=e.querySelector(".nhsuk-tabs__tab")),s&&(this.hideTab(t),this.showTab(s),s.focus(),this.createHistoryEntry(s))}activatePreviousTab(){const t=this.getCurrentTab(),e=t.parentNode.previousElementSibling;let s;e&&(s=e.querySelector(".nhsuk-tabs__tab")),s&&(this.hideTab(t),this.showTab(s),s.focus(),this.createHistoryEntry(s))}getPanel(t){return this.$root.querySelector(Tabs.getHref(t))}showPanel(t){const e=this.getPanel(t);e.classList.remove(this.jsHiddenClass),e.dispatchEvent(this.showEvent)}hidePanel(t){const e=this.getPanel(t);e.classList.add(this.jsHiddenClass),e.dispatchEvent(this.hideEvent)}unhighlightTab(t){t.setAttribute("aria-selected","false"),t.parentNode.classList.remove("nhsuk-tabs__list-item--selected"),t.setAttribute("tabindex","-1")}highlightTab(t){t.setAttribute("aria-selected","true"),t.parentNode.classList.add("nhsuk-tabs__list-item--selected"),t.setAttribute("tabindex","0")}getCurrentTab(){return this.$root.querySelector(".nhsuk-tabs__list-item--selected .nhsuk-tabs__tab")}static getHref(t){const e=t.getAttribute("href");return e.slice(e.indexOf("#"),e.length)}}function initTabs(t={}){(t.scope||document).querySelectorAll('[data-module="nhsuk-tabs"]').forEach((t=>{new Tabs(t)}))}function initAll(t){const e={scope:t||document};initHeader(e),initSkipLink(e),initButton(e),initCharacterCount(e),initCheckboxes(e),initDetails(e),initErrorSummary(e),initRadios(e),initTabs(e)}export{Button,CharacterCount,Checkboxes,Details,ErrorSummary,Header,Radios,SkipLink,Tabs,initAll,initButton,initCharacterCount,initCheckboxes,initDetails,initErrorSummary,initHeader,initRadios,initSkipLink,initTabs};//# sourceMappingURL=nhsuk-frontend.min.js.map
