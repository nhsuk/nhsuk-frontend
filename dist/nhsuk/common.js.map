{"version":3,"file":"common.js","sources":["../../src/nhsuk/common.mjs"],"sourcesContent":["/**\n * Toggle a boolean attribute on a HTML element\n *\n * @param {HTMLElement} element\n * @param {string} attr\n */\nexport function toggleAttribute(element, attr) {\n  // Return without error if element or attr are missing\n  if (!element || !attr) return\n  // Toggle attribute value. Treat no existing attr same as when set to false\n  const value = element.getAttribute(attr) === 'true' ? 'false' : 'true'\n  element.setAttribute(attr, value)\n}\n\n/**\n * Toggle a toggle a class on conditional content for an input based on checked state\n *\n * @param {HTMLElement} input - input element\n * @param {string} className - class to toggle\n */\nexport function toggleConditionalInput(input, className) {\n  // Return without error if input or class are missing\n  if (!input || !className) return\n  // If the input has conditional content it had a data-aria-controls attribute\n  const conditionalId = input.getAttribute('aria-controls')\n  if (conditionalId) {\n    // Get the conditional element from the input data-aria-controls attribute\n    const conditionalElement = document.getElementById(conditionalId)\n    if (conditionalElement) {\n      if (input.checked) {\n        conditionalElement.classList.remove(className)\n        input.setAttribute('aria-expanded', 'true')\n      } else {\n        conditionalElement.classList.add(className)\n        input.setAttribute('aria-expanded', 'false')\n      }\n    }\n  }\n}\n\n/**\n * Used to generate a unique string, allows multiple instances of the component\n * without them conflicting with each other.\n * https://stackoverflow.com/a/8809472\n *\n * Original code taken from GDS (Government Digital Service)\n * {@link https://github.com/alphagov/govuk-frontend}\n */\nexport function generateUniqueID() {\n  let d = new Date().getTime()\n  if (\n    typeof window.performance !== 'undefined' &&\n    typeof window.performance.now === 'function'\n  ) {\n    d += window.performance.now() // use high-precision timer if available\n  }\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (d + Math.random() * 16) % 16 | 0\n    d = Math.floor(d / 16)\n    return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16)\n  })\n}\n\n/**\n * Move focus to element\n *\n * Sets tabindex to -1 to make the element programmatically focusable,\n * but removes it on blur as the element doesn't need to be focused again.\n *\n * Original code taken from GDS (Government Digital Service)\n * {@link https://github.com/alphagov/govuk-frontend}\n *\n * @template {HTMLElement} FocusElement\n * @param {FocusElement} $element - HTML element\n * @param {object} [options] - Handler options\n * @param {function(this: FocusElement): void} [options.onBeforeFocus] - Callback before focus\n * @param {function(this: FocusElement): void} [options.onBlur] - Callback on blur\n */\nexport function setFocus($element, options = {}) {\n  const isFocusable = $element.getAttribute('tabindex')\n\n  if (!isFocusable) {\n    $element.setAttribute('tabindex', '-1')\n  }\n\n  /**\n   * Handle element focus\n   */\n  function onFocus() {\n    $element.removeEventListener('focus', onFocus)\n    $element.addEventListener('blur', onBlur)\n  }\n\n  /**\n   * Handle element blur\n   */\n  function onBlur() {\n    $element.removeEventListener('blur', onBlur)\n\n    if (options.onBlur) {\n      options.onBlur.call($element)\n    }\n\n    if (!isFocusable) {\n      $element.removeAttribute('tabindex')\n    }\n  }\n\n  // Add listener to reset element on blur, after focus\n  $element.addEventListener('focus', onFocus)\n\n  // Focus element\n  if (options.onBeforeFocus) {\n    options.onBeforeFocus.call($element)\n  }\n\n  $element.focus()\n}\n"],"names":["toggleAttribute","element","attr","value","getAttribute","setAttribute","toggleConditionalInput","input","className","conditionalId","conditionalElement","document","getElementById","checked","classList","remove","add","generateUniqueID","d","Date","getTime","window","performance","now","replace","c","r","Math","random","floor","toString","setFocus","$element","options","isFocusable","onFocus","removeEventListener","addEventListener","onBlur","call","removeAttribute","onBeforeFocus","focus"],"mappings":"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"}