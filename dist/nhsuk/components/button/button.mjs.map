{"version":3,"file":"button.mjs","sources":["../../../../src/nhsuk/components/button/button.mjs"],"sourcesContent":["const KEY_SPACE = 32\nconst DEBOUNCE_TIMEOUT_IN_SECONDS = 1\n\n/**\n * Button component\n */\nexport class Button {\n  /**\n   * @param {Element | null} [$root] - HTML element to use for component\n   */\n  constructor($root) {\n    if (!$root || !($root instanceof HTMLElement)) {\n      return this\n    }\n\n    this.$root = $root\n    this.debounceFormSubmitTimer = null\n\n    /**\n     * Initialise an event listener for keydown at document level\n     * this will help listening for later inserted elements with a role=\"button\"\n     */\n    this.$root.addEventListener('keydown', this.handleKeyDown.bind(this))\n    this.$root.addEventListener('click', this.debounce.bind(this))\n  }\n\n  /**\n   * JavaScript 'shim' to trigger the click event of element(s) when the space key is pressed.\n   *\n   * Created since some Assistive Technologies (for example some Screenreaders)\n   * will tell a user to press space on a 'button', so this functionality needs to be shimmed\n   * See https://github.com/alphagov/govuk_elements/pull/272#issuecomment-233028270\n   *\n   * @param {KeyboardEvent} event - Keydown event\n   */\n  handleKeyDown(event) {\n    // get the target element\n\n    const { target } = event\n    // if the element has a role='button' and the pressed key is a space, we'll simulate a click\n    if (\n      target.getAttribute('role') === 'button' &&\n      event.keyCode === KEY_SPACE\n    ) {\n      event.preventDefault()\n      // trigger the target's click event\n      target.click()\n    }\n  }\n\n  /**\n   * If the click quickly succeeds a previous click then nothing will happen.\n   * This stops people accidentally causing multiple form submissions by\n   * double clicking buttons.\n   */\n  debounce(event) {\n    const { target } = event\n    // Check the button that is clicked on has the preventDoubleClick feature enabled\n    if (target.getAttribute('data-prevent-double-click') !== 'true') {\n      return\n    }\n\n    // If the timer is still running then we want to prevent the click from submitting the form\n    if (this.debounceFormSubmitTimer) {\n      event.preventDefault()\n      return false // eslint-disable-line consistent-return\n    }\n\n    this.debounceFormSubmitTimer = setTimeout(() => {\n      this.debounceFormSubmitTimer = null\n    }, DEBOUNCE_TIMEOUT_IN_SECONDS * 1000)\n  }\n}\n\n/**\n * Initialise button component\n *\n * @param {object} [options]\n * @param {Element | Document | null} [options.scope] - Scope of the document to search within\n */\nexport function initButton(options = {}) {\n  const $scope = options.scope || document\n  const $buttons = $scope.querySelectorAll('[data-module=\"nhsuk-button\"]')\n\n  $buttons.forEach(($root) => {\n    new Button($root)\n  })\n}\n"],"names":["KEY_SPACE","DEBOUNCE_TIMEOUT_IN_SECONDS","Button","constructor","$root","HTMLElement","debounceFormSubmitTimer","addEventListener","handleKeyDown","bind","debounce","event","target","getAttribute","keyCode","preventDefault","click","setTimeout","initButton","options","$scope","scope","document","$buttons","querySelectorAll","forEach"],"mappings":"AAAA,MAAMA,SAAS,GAAG,EAAE;AACpB,MAAMC,2BAA2B,GAAG,CAAC;;AAErC;AACA;AACA;AACO,MAAMC,MAAM,CAAC;AAClB;AACF;AACA;EACEC,WAAWA,CAACC,KAAK,EAAE;IACjB,IAAI,CAACA,KAAK,IAAI,EAAEA,KAAK,YAAYC,WAAW,CAAC,EAAE;AAC7C,MAAA,OAAO,IAAI;AACb;IAEA,IAAI,CAACD,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACE,uBAAuB,GAAG,IAAI;;AAEnC;AACJ;AACA;AACA;AACI,IAAA,IAAI,CAACF,KAAK,CAACG,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACC,aAAa,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;AACrE,IAAA,IAAI,CAACL,KAAK,CAACG,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACG,QAAQ,CAACD,IAAI,CAAC,IAAI,CAAC,CAAC;AAChE;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACED,aAAaA,CAACG,KAAK,EAAE;AACnB;;IAEA,MAAM;AAAEC,MAAAA;AAAO,KAAC,GAAGD,KAAK;AACxB;AACA,IAAA,IACEC,MAAM,CAACC,YAAY,CAAC,MAAM,CAAC,KAAK,QAAQ,IACxCF,KAAK,CAACG,OAAO,KAAKd,SAAS,EAC3B;MACAW,KAAK,CAACI,cAAc,EAAE;AACtB;MACAH,MAAM,CAACI,KAAK,EAAE;AAChB;AACF;;AAEA;AACF;AACA;AACA;AACA;EACEN,QAAQA,CAACC,KAAK,EAAE;IACd,MAAM;AAAEC,MAAAA;AAAO,KAAC,GAAGD,KAAK;AACxB;IACA,IAAIC,MAAM,CAACC,YAAY,CAAC,2BAA2B,CAAC,KAAK,MAAM,EAAE;AAC/D,MAAA;AACF;;AAEA;IACA,IAAI,IAAI,CAACP,uBAAuB,EAAE;MAChCK,KAAK,CAACI,cAAc,EAAE;AACtB,MAAA,OAAO,KAAK,CAAA;AACd;AAEA,IAAA,IAAI,CAACT,uBAAuB,GAAGW,UAAU,CAAC,MAAM;MAC9C,IAAI,CAACX,uBAAuB,GAAG,IAAI;AACrC,KAAC,EAAEL,2BAA2B,GAAG,IAAI,CAAC;AACxC;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASiB,UAAUA,CAACC,OAAO,GAAG,EAAE,EAAE;AACvC,EAAA,MAAMC,MAAM,GAAGD,OAAO,CAACE,KAAK,IAAIC,QAAQ;AACxC,EAAA,MAAMC,QAAQ,GAAGH,MAAM,CAACI,gBAAgB,CAAC,8BAA8B,CAAC;AAExED,EAAAA,QAAQ,CAACE,OAAO,CAAErB,KAAK,IAAK;IAC1B,IAAIF,MAAM,CAACE,KAAK,CAAC;AACnB,GAAC,CAAC;AACJ;;;;"}