{"version":3,"file":"details.js","sources":["../../../../src/nhsuk/components/details/details.mjs"],"sourcesContent":["import { generateUniqueID, toggleAttribute } from '../../common.mjs'\n\n/**\n * Details component\n *\n * Ensure details component is cross browser and accessible\n * Test at http://localhost:3000/nhsuk-frontend/components/details/index.html\n */\nexport class Details {\n  /**\n   * @param {Element | null} [$root] - HTML element to use for component\n   */\n  constructor($root) {\n    if (!$root || !($root instanceof HTMLElement)) {\n      return this\n    }\n\n    this.$root = $root\n\n    // If there is native details support, we want to avoid running code to polyfill native behaviour.\n    const hasNativeDetails =\n      'HTMLDetailsElement' in window && this.$root instanceof HTMLDetailsElement\n\n    if (!hasNativeDetails) {\n      this.polyfillDetails()\n    }\n  }\n\n  /**\n   * Adds all necessary functionality to a details element\n   */\n  polyfillDetails() {\n    // Set content element and give it an ID if it doesn't already have one\n    const content = this.$root.querySelector('.nhsuk-details__text')\n    if (!content.id) {\n      content.setAttribute('id', `details-content-${generateUniqueID()}`)\n    }\n\n    // Set summary element\n    const summary = this.$root.querySelector('.nhsuk-details__summary')\n\n    // Set initial summary aria attributes\n    summary.setAttribute('role', 'button')\n    summary.setAttribute('aria-controls', content.id)\n    summary.setAttribute('tabIndex', '0')\n    const openAttr = this.$root.getAttribute('open') !== null\n    if (openAttr === true) {\n      summary.setAttribute('aria-expanded', 'true')\n      content.setAttribute('aria-hidden', 'false')\n    } else {\n      summary.setAttribute('aria-expanded', 'false')\n      content.setAttribute('aria-hidden', 'true')\n      content.style.display = 'none'\n    }\n\n    const toggleDetails = () => {\n      toggleAttribute(summary, 'aria-expanded')\n      toggleAttribute(content, 'aria-hidden')\n\n      content.style.display =\n        content.getAttribute('aria-hidden') === 'true' ? 'none' : ''\n      if (this.$root.hasAttribute('open')) {\n        this.$root.removeAttribute('open')\n      } else {\n        this.$root.setAttribute('open', 'open')\n      }\n    }\n\n    // Toggle details onclick\n    summary.addEventListener('click', toggleDetails)\n\n    // Call toggle details on enter and space key events\n    summary.addEventListener('keydown', (event) => {\n      if (event.keyCode === 13 || event.keyCode === 32) {\n        event.preventDefault()\n        summary.click()\n      }\n    })\n  }\n}\n\n/**\n * Initialise details component\n *\n * @param {object} [options]\n * @param {Element | Document | null} [options.scope] - Scope of the document to search within\n */\nexport function initDetails(options = {}) {\n  const $scope = options.scope || document\n  const $details = $scope.querySelectorAll('.nhsuk-details')\n\n  $details.forEach(($root) => {\n    new Details($root)\n  })\n}\n"],"names":["Details","constructor","$root","HTMLElement","hasNativeDetails","window","HTMLDetailsElement","polyfillDetails","content","querySelector","id","setAttribute","generateUniqueID","summary","openAttr","getAttribute","style","display","toggleDetails","toggleAttribute","hasAttribute","removeAttribute","addEventListener","event","keyCode","preventDefault","click","initDetails","options","$scope","scope","document","$details","querySelectorAll","forEach"],"mappings":"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"}