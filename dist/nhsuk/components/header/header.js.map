{"version":3,"file":"header.js","sources":["../../../../src/nhsuk/components/header/header.mjs"],"sourcesContent":["/**\n * Header component\n */\nexport class Header {\n  /**\n   * @param {Element | null} [$root] - HTML element to use for component\n   */\n  constructor($root) {\n    if (!$root || !($root instanceof HTMLElement)) {\n      return this\n    }\n\n    this.$root = $root\n\n    this.navigation = this.$root.querySelector('.nhsuk-header__navigation')\n    this.navigationList = this.$root.querySelector(\n      '.nhsuk-header__navigation-list'\n    )\n    this.navigationItems = this.$root.querySelectorAll(\n      '.nhsuk-header__navigation-item'\n    )\n\n    this.menu = this.$root.querySelector('.nhsuk-header__menu')\n    this.menuToggle = this.$root.querySelector('.nhsuk-header__menu-toggle')\n\n    if (\n      !this.navigation ||\n      !this.navigationList ||\n      !this.navigationItems ||\n      !this.navigationItems.length ||\n      !this.menu ||\n      !this.menuToggle\n    ) {\n      return this\n    }\n\n    this.menuList = document.createElement('ul')\n\n    this.menuIsEnabled = false\n    this.menuIsOpen = false\n\n    this.handleEscapeKey = this.onEscapeKey.bind(this)\n    this.handleUpdateNavigation = this.debounce(this.updateNavigation)\n    this.handleToggleMenu = this.toggleMenu.bind(this)\n\n    this.setupNavigation()\n    this.updateNavigation()\n  }\n\n  debounce(func, timeout = 100) {\n    let timer\n    return (...args) => {\n      clearTimeout(timer)\n      timer = setTimeout(() => {\n        func.apply(this, args)\n      }, timeout)\n    }\n  }\n\n  /**\n   * Reset navigation\n   *\n   * Calculate available space by summing the width of each navigation item\n   */\n  resetNavigation() {\n    let right = 0\n\n    // Reset and calculate widths on every resize\n    this.breakpoints.forEach((breakpoint) => {\n      this.navigationList.insertBefore(breakpoint.element, this.menu)\n\n      // Calculate widths\n      right += breakpoint.element.offsetWidth\n      breakpoint.right = right\n    })\n\n    // Reset space for menu button\n    this.width = this.navigationList.offsetWidth\n  }\n\n  /**\n   * Add the breakpoints with default positions\n   */\n  setupNavigation() {\n    this.breakpoints = []\n\n    this.navigationItems.forEach((element) => {\n      this.breakpoints.push({ element, right: 0 })\n    })\n\n    // Add resize listener for next update\n    window.addEventListener('resize', this.handleUpdateNavigation)\n  }\n\n  /**\n   * Add the menu to the DOM\n   */\n  setupMenu() {\n    if (this.menuList.parentElement) {\n      return\n    }\n\n    this.menuList.classList.add('nhsuk-header__menu-list')\n    this.menuList.setAttribute('hidden', '')\n    this.menu.appendChild(this.menuList)\n  }\n\n  /**\n   * Enable the menu\n   */\n  enableMenu() {\n    if (this.menuIsEnabled) {\n      return\n    }\n\n    this.menuIsEnabled = true\n    this.menu.removeAttribute('hidden')\n\n    // Add click listener to toggle menu\n    this.menuToggle.addEventListener('click', this.handleToggleMenu)\n  }\n\n  /**\n   * Disable the menu\n   */\n  disableMenu() {\n    if (!this.menuIsEnabled) {\n      return\n    }\n\n    this.closeMenu()\n    this.menuIsEnabled = false\n    this.menu.setAttribute('hidden', '')\n\n    // Remove click listener from toggle menu\n    this.menuToggle.removeEventListener('click', this.handleToggleMenu)\n  }\n\n  /**\n   * Close the menu\n   *\n   * Closes the menu and updates accessibility state.\n   *\n   * Removes the bottom border from the navigation\n   */\n  closeMenu() {\n    if (!this.menuIsEnabled || !this.menuIsOpen) {\n      return\n    }\n\n    this.menuIsOpen = false\n    this.menuList.setAttribute('hidden', '')\n    this.menuToggle.setAttribute('aria-expanded', 'false')\n    this.navigation.style.removeProperty('border-bottom-width')\n\n    // Remove escape key listener to close menu\n    document.removeEventListener('keydown', this.handleEscapeKey)\n  }\n\n  /**\n   * Escape key handler\n   *\n   * This function is called when the user\n   * presses the escape key to close the menu.\n   *\n   * @param {KeyboardEvent} event - Key press event\n   */\n  onEscapeKey(event) {\n    if (event.key === 'Escape') {\n      this.closeMenu()\n    }\n  }\n\n  /**\n   * Open the menu\n   *\n   * Opens the menu and updates accessibility state.\n   *\n   * The menu is absolutely positioned, so it adds a border\n   * to the bottom of the navigation to prevent it from overlapping\n   *\n   * Adds event listeners for the close button,\n   */\n  openMenu() {\n    if (!this.menuIsEnabled || this.menuIsOpen) {\n      return\n    }\n\n    this.menuIsOpen = true\n    this.menuList.removeAttribute('hidden')\n    this.menuToggle.setAttribute('aria-expanded', 'true')\n    this.navigation.style.setProperty(\n      'border-bottom-width',\n      `${this.menuList.offsetHeight}px`\n    )\n\n    // Add escape key listener to close menu\n    document.addEventListener('keydown', this.handleEscapeKey)\n  }\n\n  /**\n   * Handle menu button click\n   *\n   * Toggles the menu between open and closed\n   */\n  toggleMenu() {\n    if (!this.menuIsEnabled) {\n      return\n    }\n\n    if (this.menuIsOpen) {\n      this.closeMenu()\n    } else {\n      this.openMenu()\n    }\n  }\n\n  /**\n   * Update navigation for the available space\n   *\n   * Moves all items that overflow the available space into the menu\n   */\n  updateNavigation() {\n    this.resetNavigation()\n\n    // Check for items that overflow\n    let menuItems = this.breakpoints.filter((breakpoint) => {\n      return breakpoint.right > this.width\n    })\n\n    // Disable menu if empty\n    if (!menuItems.length) {\n      this.disableMenu()\n      return\n    }\n\n    this.setupMenu()\n    this.enableMenu()\n\n    // Subtract space for menu button\n    this.width -= this.menu.offsetWidth\n\n    // Move items based on available width\n    this.breakpoints.forEach((breakpoint) => {\n      if (breakpoint.right > this.width) {\n        this.menuList.insertAdjacentElement('beforeend', breakpoint.element)\n      }\n    })\n\n    // Update menu height if open\n    if (this.menuIsOpen) {\n      this.navigation.style.setProperty(\n        'border-bottom-width',\n        `${this.menuList.offsetHeight}px`\n      )\n    }\n  }\n}\n\n/**\n * Initialise header component\n *\n * @param {object} [options]\n * @param {Element | Document | null} [options.scope] - Scope of the document to search within\n */\nexport function initHeader(options = {}) {\n  const $scope = options.scope || document\n  const $root = $scope.querySelector('.nhsuk-header')\n\n  new Header($root)\n}\n"],"names":["Header","constructor","$root","HTMLElement","navigation","querySelector","navigationList","navigationItems","querySelectorAll","menu","menuToggle","length","menuList","document","createElement","menuIsEnabled","menuIsOpen","handleEscapeKey","onEscapeKey","bind","handleUpdateNavigation","debounce","updateNavigation","handleToggleMenu","toggleMenu","setupNavigation","func","timeout","timer","args","clearTimeout","setTimeout","apply","resetNavigation","right","breakpoints","forEach","breakpoint","insertBefore","element","offsetWidth","width","push","window","addEventListener","setupMenu","parentElement","classList","add","setAttribute","appendChild","enableMenu","removeAttribute","disableMenu","closeMenu","removeEventListener","style","removeProperty","event","key","openMenu","setProperty","offsetHeight","menuItems","filter","insertAdjacentElement","initHeader","options","$scope","scope"],"mappings":"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"}