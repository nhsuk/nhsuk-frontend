.nhsuk-service-navigation {
  @include print-hide;
  background-color: $color_nhsuk-blue;
  color: $color_nhsuk-white;
  position: relative;
}

.nhsuk-service-navigation__wrapper {
  @include govuk-width-container;
  border-top: 1px solid $color_transparent_nhsuk-white-20;

  @include mq($until: tablet) {
    position: relative;
    z-index: 10;
  }
}

// Visible navigation list
.nhsuk-service-navigation__list {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  margin: 0 (nhsuk-spacing(2) * -1);
  padding: 0;
  width: calc(100% + nhsuk-spacing(2) + nhsuk-spacing(2));

  @include mq($from: tablet) {
    margin: 0 (nhsuk-spacing(3) * -1);
    width: calc(100% + nhsuk-spacing(3) + nhsuk-spacing(3));
  }

  .js-enabled & {
    flex-wrap: nowrap;
  }
}

.nhsuk-service-navigation__list--justified {
  @include mq($from: desktop) {
    justify-content: space-between;
  }
}

.nhsuk-service-navigation__item {
  margin-bottom: 0;
  padding: 0 nhsuk-spacing(2);

  @include mq($from: tablet) {
    padding: 0 nhsuk-spacing(3);
  }
}

// This is a <strong> element used as a fallback mechanism for visually
// indicating current page in scenarios where CSS isn’t available.
// We don’t actually want it to be bold normally, so inherit parent font-weight.
.nhsuk-service-navigation__item--active-fallback {
  font-weight: inherit;
}

.nhsuk-service-navigation__link,
.nhsuk-service-navigation__toggle {
  @include nhsuk-font(16);
  @include nhsuk-link-style-header;
  display: block;
  font-size: inherit;
  padding: nhsuk-spacing(3) 2px;
  white-space: nowrap;

  // Visual indicator for current navigation item has grey line on bottom edge,
  // and no underline on the link.
  &[aria-current="page"],
  &[aria-current="true"] {
    text-decoration: none;
    box-shadow: inset 0 ($nhsuk-focus-width * -1) $nhsuk-border-color;
  }

  &:focus {
    box-shadow: inset 0 ($nhsuk-focus-width * -1) $nhsuk-focus-text-color;
  }
}

// Overflow navigation toggle (shown when screen can’t fit all nav items)
.nhsuk-service-navigation__toggle {
  background: transparent;
  border: 0;
  border-radius: 0;
  box-sizing: border-box;
  cursor: pointer;
  margin: 0;
  overflow: visible;
  position: relative;
  right: 0;
  text-align: center;
  vertical-align: top;
  visibility: hidden;
  width: auto;
  z-index: 1;

  &[aria-expanded="true"] .nhsuk-icon__chevron-down {
    transform: rotate(270deg);
  }
}

.nhsuk-service-navigation__toggle--visible {
  visibility: visible;
  display: flex;
}

// Overflow navigation
.nhsuk-service-navigation__overflow {
  @include print-hide;
  background-color: $color_nhsuk-white;
  border-bottom: nhsuk-spacing(1) solid $color_nhsuk-grey-4;
  list-style: none;
  margin: 0;
  overflow: hidden;
  padding: 0;
  position: absolute;
  right: 0;
  top: 100%;
  left: 0;

  &[hidden] {
    display: none;
  }

  @include mq($until: tablet) {
    margin: 0 (nhsuk-spacing(3) * -1);
  }

  .nhsuk-service-navigation__link {
    @include govuk-width-container;
    @include nhsuk-link-style-no-visited-state;

    // When in expanded menu, a current item link should revert to having a
    // no box-shadow, with a box-shadow added to containing list item instead.
    &[aria-current="page"],
    &[aria-current="true"] {
      box-shadow: none;
    }

    // But when focused the black line at the bottom should return,
    // again using box-shadow.
    &:focus {
      box-shadow: inset 0 ($nhsuk-focus-width * -1) $nhsuk-focus-text-color;
    }
  }

  .nhsuk-service-navigation__item {
    border-top: 1px solid $color_nhsuk-grey-5;
    padding: 0;
  }

  // Current item within expended mobile menu gets blue line on left edge.
  //
  // The blue line uses an inset box-shadow instead of a border, as there’s
  // already a grey border on the top, and using 2 different colour borders
  // creates an awkward diagonal line where they meet.
  .nhsuk-service-navigation__item--current {
    box-shadow: inset 6px 0 $color_nhsuk-blue;
  }
}

// Overflow navigation container
.nhsuk-service-navigation__item--overflow {
  align-self: center;
  padding: 0 nhsuk-spacing(2);

  &[hidden] {
    display: none;
  }

  @include mq($from: tablet) {
    padding: 0 nhsuk-spacing(3);
  }
}
