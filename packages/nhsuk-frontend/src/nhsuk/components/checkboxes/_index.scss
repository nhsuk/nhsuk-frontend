@use "sass:math";
@use "../../core/settings" as *;
@use "../../core/tools" as *;

////
/// Checkboxes component
///
/// 1. remove 300ms pause on mobile.
/// 2. Fix bug in IE11 caused by transform rotate (-45deg).
///
/// @group components/checkboxes
////

$nhsuk-checkboxes-size: nhsuk-spacing(6);
$nhsuk-checkboxes-label-padding-left-right: 12px;

@include nhsuk-exports("nhsuk/components/checkboxes") {
  .nhsuk-checkboxes__item {
    display: block;

    position: relative;

    min-height: $nhsuk-checkboxes-size;
    margin-bottom: nhsuk-spacing(2);
    padding: 0 0 0 $nhsuk-checkboxes-size;

    clear: left;

    @include nhsuk-font(19);
  }

  .nhsuk-checkboxes__item:last-child,
  .nhsuk-checkboxes__item:last-of-type {
    margin-bottom: 0;
  }

  .nhsuk-checkboxes__input {
    position: absolute;
    z-index: 1;
    top: 0;
    left: 0;

    width: $nhsuk-checkboxes-size;
    height: $nhsuk-checkboxes-size;
    margin: 0;

    opacity: 0;

    cursor: pointer;
  }

  .nhsuk-checkboxes__label {
    box-sizing: border-box;

    display: inline-block;

    margin-bottom: 0;
    padding: 8px $nhsuk-checkboxes-label-padding-left-right nhsuk-spacing(1);

    cursor: pointer;

    touch-action: manipulation; // [1]
  }

  .nhsuk-checkboxes__hint {
    display: block;
    padding-right: $nhsuk-checkboxes-label-padding-left-right;
    padding-left: $nhsuk-checkboxes-label-padding-left-right;
  }

  .nhsuk-checkboxes__input + .nhsuk-checkboxes__label::before {
    content: "";

    box-sizing: border-box;

    position: absolute;
    top: 0;
    left: 0;

    width: $nhsuk-checkboxes-size;
    height: $nhsuk-checkboxes-size;

    border: $nhsuk-border-width-form-element solid $nhsuk-input-border-colour;

    background: $nhsuk-input-background-colour;
  }

  .nhsuk-checkboxes__input + .nhsuk-checkboxes__label::after {
    content: "";

    position: absolute;
    top: 13px;
    left: 10px;

    width: 22px;
    height: 10px;

    transform: rotate(-45deg);

    border: solid;
    border-width: 0 0 $nhsuk-border-width $nhsuk-border-width;
    border-top-color: transparent;

    opacity: 0; // [2]

    background: transparent;
  }

  // Focus state
  //
  // 1. Since box-shadows are removed when users customise their colours
  //    We set a transparent outline that is shown instead.

  .nhsuk-checkboxes__input:focus + .nhsuk-checkboxes__label::before {
    @include nhsuk-focused-checkbox;
  }

  // Selected state

  .nhsuk-checkboxes__input:checked + .nhsuk-checkboxes__label::after {
    opacity: 1;
  }

  // Disabled state

  .nhsuk-checkboxes__input:disabled,
  .nhsuk-checkboxes__input:disabled + .nhsuk-checkboxes__label {
    cursor: default;
  }

  .nhsuk-checkboxes__input:disabled + .nhsuk-checkboxes__label {
    opacity: 0.5;
  }

  // Divider variant

  .nhsuk-checkboxes__divider {
    $nhsuk-divider-size: $nhsuk-checkboxes-size !default;
    width: $nhsuk-divider-size;
    margin-bottom: nhsuk-spacing(2);
    color: $nhsuk-text-colour;
    text-align: center;

    @include nhsuk-font(19);
  }

  // Conditional
  //
  // 1. Calculate the amount of padding needed to keep the border
  //    centered against the checkbox.
  // 2. Move the border centered with the checkbox.
  // 3. Move the contents of the conditional inline with the label.

  .nhsuk-checkboxes__conditional {
    $conditional-border-width: $nhsuk-border-width;
    $conditional-border-padding: math.div($nhsuk-checkboxes-size, 2) - math.div($conditional-border-width, 2); // [1]
    $conditional-margin-left: $conditional-border-padding; // [2]
    $conditional-padding-left: $conditional-border-padding + $nhsuk-checkboxes-label-padding-left-right; // [3]
    margin-left: $conditional-margin-left;
    padding-left: $conditional-padding-left;
    border-left: $conditional-border-width solid $nhsuk-input-border-colour;
    @include nhsuk-responsive-margin(4, "bottom");

    & > :last-child {
      margin-bottom: 0;
    }
  }

  .nhsuk-frontend-supported .nhsuk-checkboxes__conditional--hidden {
    display: none;
  }
}
