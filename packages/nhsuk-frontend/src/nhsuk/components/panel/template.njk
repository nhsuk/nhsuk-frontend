{% from "nhsuk/macros/attributes.njk" import nhsukAttributes %}

{% set headingLevel = params.headingLevel if params.headingLevel else 1 -%}

<div {%- if params.id %} id="{{ params.id }}"{% endif %} class="nhsuk-panel
  {%- if params.classes %} {{ params.classes }}{% endif %}"
  {{- nhsukAttributes(params.attributes) }}>
  {%- set classNamesTitle = "nhsuk-panel__title" -%}
  {%- if params.titleSize and
    params.titleSize in ["s", "m", "l", "xl"] and (
      not params.titleClasses or (
        not "nhsuk-panel__title--s" in params.titleClasses and
        not "nhsuk-panel__title--m" in params.titleClasses and
        not "nhsuk-panel__title--l" in params.titleClasses and
        not "nhsuk-panel__title--xl" in params.titleClasses
      )
    )
  %}
    {% set classNamesTitle = classNamesTitle ~ " nhsuk-panel__title--" ~ params.titleSize %}
  {% endif %}
  {%- if params.titleClasses %}
    {% set classNamesTitle = classNamesTitle ~ " " ~ params.titleClasses %}
  {% endif %}
  <h{{ headingLevel }} class="{{ classNamesTitle }}">
    {{ params.titleHtml | safe if params.titleHtml else params.titleText }}
  </h{{ headingLevel }}>
  {% if caller or params.html or params.text %}
  <div class="nhsuk-panel__body">
    {{ caller() if caller else (params.html | safe | trim | indent(4) if params.html else params.text) }}
  </div>
  {% endif %}
</div>
