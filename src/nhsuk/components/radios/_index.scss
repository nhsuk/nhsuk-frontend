@use "sass:math";
@use "../../core/settings" as *;
@use "../../core/tools" as *;

////
/// Radios component
///
/// 1. remove 300ms pause on mobile.
/// 2. Fix bug in IE11 caused by transform rotate (-45deg).
///
/// @group components/radios
////

$nhsuk-radios-size: nhsuk-spacing(6);
$nhsuk-radios-label-padding-left-right: 12px;

// When the default focus width is used on a curved edge it looks visually smaller.
// So for the circular radios we bump the default to make it look visually consistent.
$nhsuk-radios-focus-width: $nhsuk-focus-width + 1px;

@include nhsuk-exports("nhsuk/components/radios") {
  .nhsuk-radios__item {
    display: block;

    position: relative;

    min-height: $nhsuk-radios-size;
    margin-bottom: nhsuk-spacing(2);
    padding: 0 0 0 $nhsuk-radios-size;

    clear: left;

    @include nhsuk-font(19);
  }

  .nhsuk-radios__item:last-child,
  .nhsuk-radios__item:last-of-type {
    margin-bottom: 0;
  }

  .nhsuk-radios__input {
    position: absolute;
    z-index: 1;
    top: 0;
    left: 0;

    width: $nhsuk-radios-size;
    height: $nhsuk-radios-size;
    margin: 0;

    opacity: 0;

    cursor: pointer;
  }

  .nhsuk-radios__label {
    display: inline-block;
    margin-bottom: 0;
    padding: 8px $nhsuk-radios-label-padding-left-right nhsuk-spacing(1);
    cursor: pointer;
    touch-action: manipulation; // [1]
  }

  .nhsuk-radios__hint {
    display: block;
    padding-right: $nhsuk-radios-label-padding-left-right;
    padding-left: $nhsuk-radios-label-padding-left-right;
  }

  .nhsuk-radios__input + .nhsuk-radios__label::before {
    content: "";

    box-sizing: border-box;

    position: absolute;
    top: 0;
    left: 0;

    width: $nhsuk-radios-size;
    height: $nhsuk-radios-size;

    border: $nhsuk-border-width-form-element solid $nhsuk-input-border-colour;
    border-radius: 50%;

    background: $nhsuk-input-background-colour;
  }

  .nhsuk-radios__input + .nhsuk-radios__label::after {
    content: "";

    position: absolute;
    top: 10px;
    left: 10px;

    width: 0;
    height: 0;

    border: 10px solid $nhsuk-text-colour;
    border-radius: 50%;

    opacity: 0;

    background: $nhsuk-input-border-colour;
  }

  // Focus state
  //
  // 1. Since box-shadows are removed when users customise their colours
  //    We set a transparent outline that is shown instead.

  .nhsuk-radios__input:focus + .nhsuk-radios__label::before {
    @include nhsuk-focused-radio;
  }

  // Selected state

  .nhsuk-radios__input:checked + .nhsuk-radios__label::after {
    opacity: 1;
  }

  // Disabled state

  .nhsuk-radios__input:disabled,
  .nhsuk-radios__input:disabled + .nhsuk-radios__label {
    cursor: default;
  }

  .nhsuk-radios__input:disabled + .nhsuk-radios__label {
    opacity: 0.5;
  }

  // Inline variant
  //
  // 1. Prevent inline modifier being used with conditional reveals

  .nhsuk-radios--inline {
    @include nhsuk-media-query($from: tablet) {
      @include nhsuk-clearfix;

      .nhsuk-radios__item {
        margin-right: nhsuk-spacing(4);
        float: left;
        clear: none;
      }
    }

    &.nhsuk-radios--conditional {
      // [1]
      .nhsuk-radios__item {
        margin-right: 0;
        float: none;
      }
    }
  }

  // Divider variant

  .nhsuk-radios__divider {
    $nhsuk-divider-size: $nhsuk-radios-size !default;
    width: $nhsuk-divider-size;
    margin-bottom: nhsuk-spacing(2);
    color: $nhsuk-text-colour;
    text-align: center;

    @include nhsuk-font(19);
  }

  // Conditional
  //
  // 1. Calculate the amount of padding needed to keep the border
  //    centered against the radio.
  // 2. Move the border centered with the radio.
  // 3. Move the contents of the conditional inline with the label.

  .nhsuk-radios__conditional {
    $conditional-border-width: $nhsuk-border-width;
    $conditional-border-padding: math.div($nhsuk-radios-size, 2) - math.div($conditional-border-width, 2); // [2]
    $conditional-margin-left: $conditional-border-padding; // [2]
    $conditional-padding-left: $conditional-border-padding + $nhsuk-radios-label-padding-left-right; // [3]
    margin-left: $conditional-margin-left;
    padding-left: $conditional-padding-left;
    border-left: $conditional-border-width solid $nhsuk-input-border-colour;

    @include nhsuk-responsive-margin(4, "bottom");

    & > :last-child {
      margin-bottom: 0;
    }
  }

  .nhsuk-frontend-supported .nhsuk-radios__conditional--hidden {
    display: none;
  }
}
